 <?php
 
 	

//РћРїСЂРµРґРµР»СЏРµРј С„СѓРЅРєС†РёРё, РєРѕС‚РѕСЂС‹Рµ Р±СѓРґРµРј РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ РЅР° СЌС‚РѕРј Р»РёСЃС‚Рµ

function vectorCopy($n_, $l_0, $l_k) //РљРѕРїРёСЂСѓРµРј 1 РІРµРєС‚РѕСЂ РІРѕ 2 РІРµРєС‚РѕСЂ
{	
      for ($i=1;$i<=$n_;$i++)
	  $l_k[$i]=$l_0[$i];
	  return $l_k;
}
function matrixCopy($n, $a) //РљРѕРїРёСЂСѓРµРј 1 РјР°С‚СЂРёС†Сѓ РІРѕ 2
{	
      for ($i=1;$i<=$n;$i++)
		  for ($j=1;$j<=$n;$j++)
			$b[$i][$j]=$a[$i][$j];
         /*    echo "<BR>!матрица!!!!!".$n."!!!!!!!!!!<BR>";
                for ($i=1;$i<=$n;$i++)
                {
                    for ($j=1;$j<=$n;$j++)
                    echo $a[$i][$j]." ";
                    echo "<BR>";
                }
                echo "<BR>!!!!!!!!!!!!!!!!<BR>";*/
                        
	  return $b;
}

function matrixSum($n, $a) //РЎСѓРјРјРёСЂСѓРµРј Р·РЅР°С‡РµРЅРёСЏ РјР°С‚СЂРёС†С‹
{	
	  $sum=0;
      for ($i=1;$i<=$n;$i++)
		  for ($j=1;$j<=$n;$j++)
			$sum+=$a[$i][$j];
	  return $sum;
}

function vectorOmega($n, $a, $s) //РЎСѓРјРјРёСЂСѓРµРј Р·РЅР°С‡РµРЅРёСЏ РјР°СЃСЃРёРІР°
{	
	  for ($i=1;$i<=$n;$i++)
	  $omega[$i]=0;
      for ($i=1;$i<=$n;$i++)
		  for ($j=1;$j<=$n;$j++)
			$omega[$i]=$omega[$i]+$a[$i][$j];
	   for ($i=1;$i<=$n;$i++)
		  $omega[$i]=$omega[$i]/$s;
	  return $omega;
}
 
 
 
 function iter($a, $n)
 {
include ("data/peremennie_1_laba.php");
$n_=$n;
$string = file_get_contents($a);
$result = explode(" ", $string);
$nr=0;

for ($i=1;$i<=$n;$i++)
	for ($j=1;$j<=$n;$j++)
        {
		$A_[$i][$j]=$result[$nr];
		$nr++;
	}

  for ($i=1;$i<=$n_;$i++) //Р СњР В° Р Т‘Р С‘Р В°Р С–Р С•Р Р…Р В°Р В»Р Вµ Р С?Р В°РЎвЂљРЎР‚Р С‘РЎвЂ РЎвЂ№ Р С—Р С•Р С—Р В°РЎР‚Р Р…РЎвЂ№РЎвЂ¦ РЎРѓРЎР‚Р В°Р Р†Р Р…Р ВµР Р…Р С‘Р в„– РЎРѓРЎвЂљР В°Р Р†Р С‘Р С? 1
	  for ($j=1;$j<=$n_;$j++)
		  if ($i==$j)
			  $A_[$i][$j] = 1;


	
  $l_0[1]=1; //Р СњР В°РЎвЂЎР В°Р В»РЎРЉР Р…Р С•Р Вµ Р С—РЎР‚Р С‘Р В±Р В»Р С‘Р В¶Р ВµР Р…Р С‘Р Вµ Р Р†Р ВµР С”РЎвЂљР С•РЎР‚Р В° l_0
  for ($i=2;$i<=$n_;$i++)
	  $l_0[$i]=0;

  $l_k=vectorCopy($n_, $l_0, $l_k); //Р С™Р С•Р С—Р С‘РЎР‚РЎС“Р ВµР С? Р С‘Р В· l0 Р Р† lk
 
    $l_k1 = mumnozh($A_,$l_k); //Р вЂ™РЎвЂ№РЎвЂЎР С‘РЎРѓР В»РЎРЏР ВµР С? Р Р†Р ВµР С”РЎвЂљР С•РЎР‚ l_k1
 
	$l_max=max($l_k1); //Р СњР В°РЎвЂ¦Р С•Р Т‘Р С‘Р С? Р С?Р В°Р С”РЎРѓР С‘Р С?Р В°Р В»РЎРЉР Р…Р С•Р Вµ РЎРѓР С•Р В±РЎРѓРЎвЂљР Р†Р ВµР Р…Р Р…Р С•Р Вµ РЎвЂЎР С‘РЎРѓР В»Р С•

     
   
	for ($i=1;$i<=$n_;$i++) //Р СњР С•РЎР‚Р С?Р С‘РЎР‚РЎС“Р ВµР С? Р Р†Р ВµР С”РЎвЂљР С•РЎР‚ l_k1
	{
		$l_k1_nor[$i]=$l_k1[$i]/$l_max;
		
	}
	
	for ($i=1;$i<=$n_;$i++) 
		for ($j=1;$j<=$n_;$j++)
			if ($i==$j)
				$A_lE[$i][$j]=$A_[$i][$j]-$l_max;
			else
				$A_lE[$i][$j]=$A_[$i][$j];
	
	$opredel = abs(Det($n_,$A_lE));
        

	do {
		$l_k=vectorCopy($n_, $l_k1_nor, $l_k);
     
// tut udalilcikl!!!!!!!!!!!!!!!!!!
		$l_k1 = mumnozh($A_,$l_k); //Р вЂ™РЎвЂ№РЎвЂЎР С‘РЎРѓР В»РЎРЏР ВµР С? Р Р†Р ВµР С”РЎвЂљР С•РЎР‚ l_k1
		
		$l_max=max($l_k1); //Р СњР В°РЎвЂ¦Р С•Р Т‘Р С‘Р С? Р С?Р В°Р С”РЎРѓР С‘Р С?Р В°Р В»РЎРЉР Р…Р С•Р Вµ РЎРѓР С•Р В±РЎРѓРЎвЂљР Р†Р ВµР Р…Р Р…Р С•Р Вµ РЎвЂЎР С‘РЎРѓР В»Р С•

		for ($i=1;$i<=$n_;$i++) //Р СњР С•РЎР‚Р С?Р С‘РЎР‚РЎС“Р ВµР С? Р Р†Р ВµР С”РЎвЂљР С•РЎР‚ l_k1
			$l_k1_nor[$i]=$l_k1[$i]/$l_max;
		
		for ($i=1;$i<=$n_;$i++) 
			for ($j=1;$j<=$n_;$j++)
				if ($i==$j)
					$A_lE[$i][$j]=$A_[$i][$j]-$l_max;
				else
					$A_lE[$i][$j]=$A_[$i][$j];
	
		$opredel = abs(Det($n_,$A_lE));
	} while ($opredel > 0.01);
	$S_index = $sl_in[$n_]; //Р Р€Р В·Р Р…Р В°Р ВµР С? Р РЋР В? Р Т‘Р В»РЎРЏ Р Т‘Р В°Р Р…Р Р…Р С•Р С–Р С• Р С”Р С•Р В»Р С‘РЎвЂЎР ВµРЎРѓРЎвЂљР Р†Р В° Р С—Р ВµРЎР‚Р ВµР С?Р ВµР Р…Р Р…РЎвЂ№РЎвЂ¦
	$I_S = ($l_max-1)/($n_-1); //Р вЂ™РЎвЂ№РЎвЂЎР С‘РЎРѓР В»РЎРЏР ВµР С? Р В?Р Сљ
	$O_S = $I_S/$S_index; //Р вЂ™РЎвЂ№РЎвЂЎР С‘РЎРѓР В»РЎРЏР ВµР С? Р С›Р РЋ
	if ($O_S>0.1) //Р вЂўРЎРѓР В»Р С‘ Р С›Р РЋ Р В±Р С•Р В»РЎРЉРЎв‚¬Р Вµ 0,1, РЎРѓР С•Р С•Р В±РЎвЂ°Р В°Р ВµР С? Р С—Р С•Р В»РЎРЉР В·Р С•Р Р†Р В°РЎвЂљР ВµР В»РЎР‹.
			

             for ($i=1;$i<=$n_;$i++)
                {
                    for ($j=1;$j<=$n_;$j++);
            
                }

                
                
                
                
	$A_k=matrixCopy($n_,$A_); //Р С™Р С•Р С—Р С‘РЎР‚РЎС“Р ВµР С? Р Р† Р С?Р В°РЎвЂљРЎР‚Р С‘РЎвЂ РЎС“ Р С’Р С” Р С?Р В°РЎвЂљРЎР‚Р С‘РЎвЂ РЎС“ Р С’
	
 
                        
        $S_aij=matrixSum($n_,$A_k); //Р РЋРЎС“Р С?Р С?Р С‘РЎР‚РЎС“Р ВµР С? Р Р†РЎРѓР Вµ РЎРЊР В»Р ВµР С?Р ВµР Р…РЎвЂљРЎвЂ№ Р С?Р В°РЎвЂљРЎР‚Р С‘РЎвЂ РЎвЂ№ Р С’Р С”
	for ($i=1;$i<=$n;$i++)
	$w=vectorOmega($n_,$A_k,$S_aij); //Р вЂ™РЎвЂ№РЎвЂЎР С‘РЎРѓР В»РЎРЏР ВµР С? Р Р†Р ВµР С”РЎвЂљР С•РЎР‚
	$Aw_=mumnozh($A_k,$w); //Р вЂ™РЎвЂ№РЎвЂЎР С‘РЎРѓР В»РЎРЏР ВµР С? Р Р†Р ВµР С”РЎвЂљР С•РЎР‚ 
	for ($i=1;$i<=$n_;$i++) //Р вЂ™РЎвЂ№РЎвЂЎР С‘РЎРѓР В»РЎРЏР ВµР С? Р Р†Р ВµР С”РЎвЂљР С•РЎР‚ 
		$l_w[$i]=$w[$i]*$l_max;
	for ($i=1;$i<=$n_;$i++) // Р В°Р В±РЎРѓР С•Р В»РЎР‹РЎвЂљР Р…РЎвЂ№Р Вµ Р В·Р Р…Р В°РЎвЂЎР ВµР Р…Р С‘РЎРЏ РЎР‚Р В°Р В·Р Р…Р С•РЎРѓРЎвЂљР ВµР в„– 
	$Aw_lw[$i]=abs($l_w[$i]-$Aw_[$i]);
	$eps=max($Aw_lw);
	$A_k1=mumnozh($A_,$A_k);
	do{
		$A_k=matrixCopy($n_,$A_k1);
		$S_aij=matrixSum($n_,$A_k); //Р РЋРЎС“Р С?Р С?Р С‘РЎР‚РЎС“Р ВµР С? Р Р†РЎРѓР Вµ РЎРЊР В»Р ВµР С?Р ВµР Р…РЎвЂљРЎвЂ№ Р С?Р В°РЎвЂљРЎР‚Р С‘РЎвЂ РЎвЂ№ Р С’Р С”
		$w=vectorOmega($n_,$A_k,$S_aij); //Р вЂ™РЎвЂ№РЎвЂЎР С‘РЎРѓР В»РЎРЏР ВµР С? Р Р†Р ВµР С”РЎвЂљР С•РЎР‚
		$Aw_=mumnozh($A_,$w); //Р вЂ™РЎвЂ№РЎвЂЎР С‘РЎРѓР В»РЎРЏР ВµР С? Р Р†Р ВµР С”РЎвЂљР С•РЎР‚ 
		for ($i=1;$i<=$n_;$i++) //Р вЂ™РЎвЂ№РЎвЂЎР С‘РЎРѓР В»РЎРЏР ВµР С? Р Р†Р ВµР С”РЎвЂљР С•РЎР‚ 
			$l_w[$i]=$w[$i]*$l_max;
		for ($i=1;$i<=$n_;$i++) // Р В°Р В±РЎРѓР С•Р В»РЎР‹РЎвЂљР Р…РЎвЂ№Р Вµ Р В·Р Р…Р В°РЎвЂЎР ВµР Р…Р С‘РЎРЏ РЎР‚Р В°Р В·Р Р…Р С•РЎРѓРЎвЂљР ВµР в„– 
			$Aw_lw[$i]=abs($l_w[$i]-$Aw_[$i]);
		$eps=max($Aw_lw);

             //   echo "<BR>!!!!!!!!!!!!!!!!<BR>";
		$A_k1=mumnozh($A_,$A_k);
             //   echo "<BR>!!!!!!!!!!!!!!!!<BR>";
		} while ($eps > 0.01);
for ($i=1;$i<=$n;$i++)
	$w[$i] = number_format($w[$i],3);
for ($i=1;$i<=$n;$i++)
	echo "<br>".$w[$i];

return $w;
 }		

?>